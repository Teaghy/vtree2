(function(p,g){typeof exports=="object"&&typeof module<"u"?g(exports,require("vue")):typeof define=="function"&&define.amd?define(["exports","vue"],g):(p=typeof globalThis<"u"?globalThis:p||self,g(p.virtualTree={},p.Vue))})(this,function(p,g){"use strict";var ge=Object.defineProperty;var ke=(p,g,v)=>g in p?ge(p,g,{enumerable:!0,configurable:!0,writable:!0,value:v}):p[g]=v;var f=(p,g,v)=>(ke(p,typeof g!="symbol"?g+"":g,v),v);const S=(t=>t&&typeof t=="object"&&"default"in t?t:{default:t})(g),P=["_level","_filterVisible","_parent","_loading","_loaded","_remote","_keyField","children","setChildren"];class b{constructor(e,s=null,i="id",r=!1){f(this,"_level",0);f(this,"checked",!1);f(this,"selected",!1);f(this,"indeterminate",!1);f(this,"disabled",!1);f(this,"expand",!1);f(this,"visible",!0);f(this,"_filterVisible",!0);f(this,"_parent",null);f(this,"children",[]);f(this,"isLeaf",!1);f(this,"_loading",!1);f(this,"_loaded",!1);this._keyField=i,this._remote=r;for(let a in e)P.indexOf(a)===-1&&(this[a]=e[a]);this[i]==null&&(this[i]=Math.random().toString(36).substring(2)),this._parent=s,this._parent&&(this._level=this._parent._level+1),this.visible=this._parent===null||this._parent.expand&&this._parent.visible,Array.isArray(e.children)&&this.setChildren(e.children),this.children.length&&(this._loaded=!0),this._remote||(this.isLeaf=!this.children.length)}setChildren(e){this.children=e.map(s=>new b(Object.assign({},s),this,this._keyField,this._remote))}}var w=(t=>(t.none="none",t.parents="parents",t.children="children",t))(w||{});const K=["setData","setChecked","setCheckedKeys","checkAll","clearChecked","setSelected","clearSelected","setExpand","setExpandKeys","setExpandAll","getCheckedNodes","getCheckedKeys","getIndeterminateNodes","getSelectedNode","getSelectedKey","getExpandNodes","getExpandKeys","getCurrentVisibleNodes","getNode","getTreeData","getFlatData","getNodesCount","insertBefore","insertAfter","append","prepend","remove","filter","showCheckedNodes","loadRootNodes","scrollTo"],V=["clearKeyword","getKeyword","search"];var R=(t=>(t["bottom-start"]="bottom-start",t["bottom-end"]="bottom-end",t.bottom="bottom",t["top-start"]="top-start",t["top-end"]="top-end",t.top="top",t))(R||{}),$=(t=>(t.top="top",t.center="center",t.bottom="bottom",t))($||{}),_=(t=>(t.before="before",t.body="body",t.after="after",t))(_||{});class W{constructor(e){f(this,"data",[]);f(this,"flatData",[]);f(this,"mapData",Object.create(null));f(this,"unloadCheckedKeys",[]);f(this,"unloadSelectedKey",null);f(this,"currentSelectedKey",null);f(this,"listenersMap",{});this.options=e}setData(e,s=null,i=null){this.data=e.map(r=>new b(r,null,this.options.keyField,!!this.options.load));for(let r in this.mapData)delete this.mapData[r];this.currentSelectedKey=null,this.flatData=this.flattenData(this.data),this.setUnloadCheckedKeys(i||[]),s&&(this.currentSelectedKey=null,this.setUnloadSelectedKey(s)),this.emit("visible-data-change"),this.emit("set-data")}setChecked(e,s,i=!0,r=!0,a=!1){const n=this.mapData[e];if(!n)return this.setUnloadChecked(e,s,i,r);n.disabled||n.checked&&s||!n.checked&&!n.indeterminate&&!s||(this.options.cascade?(this.checkNodeDownward(n,s,a),this.checkNodeUpward(n)):n.checked=s,i&&(n.checked?this.emit("check",n):this.emit("uncheck",n)),this.triggerCheckedChange(i,r))}setUnloadChecked(e,s,i=!0,r=!0){const a=this.findIndex(e,this.unloadCheckedKeys);s?a===-1&&this.unloadCheckedKeys.push(e):a!==-1&&this.unloadCheckedKeys.splice(a,1),this.triggerCheckedChange(i,r)}setCheckedKeys(e,s,i=!0,r=!0){e.forEach(a=>{this.setChecked(a,s,!1,!1)}),this.triggerCheckedChange(i,r)}checkAll(e=!0,s=!0){if(this.options.cascade){const i=r=>{r.forEach(a=>{a.disabled?i(a.children):this.setChecked(a[this.options.keyField],!0,!1,!1)})};i(this.data)}else{const i=this.flatData.length;for(let r=0;r<i;r++){const a=this.flatData[r];this.setChecked(a[this.options.keyField],!0,!1,!1)}}this.triggerCheckedChange(e,s)}clearChecked(e=!0,s=!0){this.getCheckedNodes().forEach(r=>{this.setChecked(r[this.options.keyField],!1,!1,!1)}),this.unloadCheckedKeys=[],this.triggerCheckedChange(e,s)}triggerCheckedChange(e=!0,s=!0){e&&this.emit("checked-change",this.getCheckedNodes(),this.getCheckedKeys()),s&&this.emit("render-data-change")}setSelected(e,s,i=!0,r=!0){const a=this.mapData[e];if(!a)return this.setUnloadSelected(e,s,i,r);a.disabled||a.selected!==s&&(e===this.currentSelectedKey?s||(a.selected=s,this.currentSelectedKey=null):s&&(this.currentSelectedKey===null?(a.selected=s,this.currentSelectedKey=a[this.options.keyField]):(this.mapData[this.currentSelectedKey]&&(this.mapData[this.currentSelectedKey].selected=!1),a.selected=s,this.currentSelectedKey=a[this.options.keyField])),i&&(a.selected?this.emit("select",a):this.emit("unselect",a),this.emit("selected-change",this.getSelectedNode(),this.getSelectedKey())),r&&this.emit("render-data-change"))}setUnloadSelected(e,s,i=!0,r=!0){s?(this.currentSelectedKey&&this.setSelected(this.currentSelectedKey,!1,!1,!1),this.unloadSelectedKey=e):this.unloadSelectedKey===e&&(this.unloadSelectedKey=null),i&&this.emit("selected-change",this.getSelectedNode(),this.getSelectedKey()),r&&this.emit("render-data-change")}clearSelected(e=!0,s=!0){this.currentSelectedKey&&this.mapData[this.currentSelectedKey]?this.setSelected(this.currentSelectedKey,!1,e,s):this.unloadSelectedKey!==null&&(this.unloadSelectedKey=null,e&&this.emit("selected-change",this.getSelectedNode(),this.getSelectedKey()),s&&this.emit("render-data-change"))}setExpand(e,s,i=!1,r=!0,a=!0){const n=this.mapData[e];if(!(!n||!i&&n.isLeaf)&&n.expand!==s){if(!n.isLeaf){if(typeof this.options.load=="function"){if(!n._loaded&&!n._loading&&s){n._loading=!0,a&&this.emit("visible-data-change"),new Promise((l,o)=>{const h=this.options.load;h(n,l,o)}).then(l=>{if(Array.isArray(l)){const o=this.findIndex(n);if(o===-1)return;n._loaded=!0,n.expand=s,n.setChildren(l);const h=this.getCheckedKeys(),c=this.flattenData(n.children,this.getSelectedKey===null);this.flatData.splice(o+1,0,...c),this.setUnloadCheckedKeys(h),this.unloadSelectedKey!==null&&this.setUnloadSelectedKey(this.unloadSelectedKey),this.emit("set-data")}}).catch(l=>{let o=l;l instanceof Error||(o=new Error(l)),console.error(o)}).then(()=>{n._loading=!1,r&&this.emit("expand",n),a&&this.emit("visible-data-change")});return}else if(n._loading)return}n.expand=s;const d=[...n.children];for(;d.length;)d[0].expand&&d[0].children.length&&d.push(...d[0].children),d[0]._filterVisible===!1?d[0].visible=!1:d[0].visible=d[0]._parent===null||d[0]._parent.expand&&d[0]._parent.visible,d.shift();r&&this.emit("expand",n),a&&this.emit("visible-data-change")}i&&n._parent&&s&&this.setExpand(n._parent[this.options.keyField],s,i,!1,a)}}setExpandKeys(e,s,i=!0){e.forEach(r=>{this.setExpand(r,s,!1,!1,!1)}),i&&this.emit("visible-data-change")}setExpandAll(e,s=!0){this.flatData.forEach(i=>{(!this.options.load||i._loaded)&&this.setExpand(i[this.options.keyField],e,!1,!1,!1)}),s&&this.emit("visible-data-change")}getCheckedNodes(e=this.options.ignoreMode){if(e===w.children){const s=[],i=r=>{r.forEach(a=>{a.checked?s.push(a):!a.isLeaf&&a.indeterminate&&i(a.children)})};return i(this.data),s}else return this.flatData.filter(s=>e===w.parents?s.checked&&s.isLeaf:s.checked)}getCheckedKeys(e=this.options.ignoreMode){return this.getCheckedNodes(e).map(s=>s[this.options.keyField]).concat(this.unloadCheckedKeys)}getIndeterminateNodes(){return this.flatData.filter(e=>e.indeterminate)}getSelectedNode(){return this.currentSelectedKey===null?null:this.mapData[this.currentSelectedKey]||null}getSelectedKey(){return this.currentSelectedKey||this.unloadSelectedKey||null}getUnloadCheckedKeys(){return this.unloadCheckedKeys}getExpandNodes(){return this.flatData.filter(e=>!e.isLeaf&&e.expand)}getExpandKeys(){return this.getExpandNodes().map(e=>e[this.options.keyField])}getNode(e){return this.mapData[e]||null}insertBefore(e,s){const i=this.getInsertedNode(e,s);if(!i)return null;this.remove(i[this.options.keyField],!1);const a=this.mapData[s]._parent,n=this.findIndex(s,a&&a.children),d=this.findIndex(s),l=a&&-1||this.findIndex(s,this.data);return this.insertIntoStore(i,a,n,d,l),this.emit("visible-data-change"),i}insertAfter(e,s){const i=this.getInsertedNode(e,s);if(!i)return null;this.remove(i[this.options.keyField],!1);const r=this.mapData[s],a=r._parent,n=this.findIndex(s,a&&a.children)+1,d=this.flatData.length,l=this.findIndex(s);let o=l+1;for(let c=l+1;c<=d;c++){if(c===d){o=c;break}if(this.flatData[c]._level<=r._level){o=c;break}}const h=a&&-1||this.findIndex(s,this.data)+1;return this.insertIntoStore(i,a,n,o,h),this.emit("visible-data-change"),i}append(e,s){const i=this.mapData[s];if(!i.isLeaf){const n=i.children.length;return this.insertAfter(e,i.children[n-1][this.options.keyField])}const r=this.getInsertedNode(e,s,!0);if(!r)return null;this.remove(r[this.options.keyField],!1);const a=this.findIndex(s)+1;return this.insertIntoStore(r,i,0,a),this.emit("visible-data-change"),r}prepend(e,s){const i=this.mapData[s];if(!i.isLeaf)return this.insertBefore(e,i.children[0][this.options.keyField]);const r=this.getInsertedNode(e,s,!0);if(!r)return null;this.remove(r[this.options.keyField],!1);const a=this.findIndex(s)+1;return this.insertIntoStore(r,i,0,a),this.emit("visible-data-change"),r}remove(e,s=!0){const i=this.mapData[e];if(!i)return null;const r=this.findIndex(i);if(r===-1)return null;let a=1;const n=this.flatData.length;for(let l=r+1;l<n&&this.flatData[l]._level>i._level;l++)a++;this.flatData.splice(r,a);const d=l=>{const o=this.mapData[l];delete this.mapData[l],o.children.forEach(h=>d(h[this.options.keyField]))};if(d(e),!i._parent){const l=this.findIndex(i,this.data);l>-1&&this.data.splice(l,1)}if(i._parent){const l=this.findIndex(i,i._parent.children);l!==-1&&i._parent.children.splice(l,1),i._parent.isLeaf=!i._parent.children.length,i._parent.isLeaf&&(i._parent.expand=!1,i._parent.indeterminate=!1),this.updateMovingNodeStatus(i)}return s&&this.emit("visible-data-change"),i}getInsertedNode(e,s,i=!1){const r=this.mapData[s];if(!r)return null;const a=i?r:r._parent;if(e instanceof b)return e[this.options.keyField]===s?null:e;if(typeof e=="object"){if(e[this.options.keyField]===s)return null;const n=this.mapData[e[this.options.keyField]];return n||new b(e,a,this.options.keyField,!!this.options.load)}else return!this.mapData[e]||e===s?null:this.mapData[e]}insertIntoStore(e,s,i,r,a){if(r===-1)return;i!==-1&&s&&s.children.splice(i,0,e),e._parent=s,s?(s.isLeaf=!1,this.setExpand(s[this.options.keyField],!0,!1,!1,!1)):typeof a=="number"&&a>-1&&this.data.splice(a,0,e);const n=this.flattenData([e]);e._level=s?s._level+1:0,n.forEach(d=>d._level=d._parent?d._parent._level+1:0),this.flatData.splice(r,0,...n),this.updateMovingNodeStatus(e)}updateMovingNodeStatus(e){this.checkNodeUpward(e),this.triggerCheckedChange(),e.selected&&this.setSelected(e[this.options.keyField],!0)}filter(e,s){const i=[];this.flatData.forEach(r=>{r._filterVisible=r._parent&&r._parent._filterVisible||s(e,r),r.visible=r._filterVisible,r._filterVisible&&i.push(r)}),i.forEach(r=>{const a=[];let n=r._parent;for(;n;)a.unshift(n),n=n._parent;a.forEach(d=>{d._filterVisible=!0,d.visible=(d._parent===null||d._parent.expand&&d._parent.visible)&&d._filterVisible,this.options.expandOnFilter&&this.setExpand(d[this.options.keyField],!0,!1,!1,!1)}),r.visible=r._parent===null||r._parent.expand&&r._parent.visible}),this.emit("visible-data-change")}setUnloadCheckedKeys(e){this.unloadCheckedKeys=e;const s=e.concat(),i=this.unloadCheckedKeys.length;for(let a=i-1;a>=0;a--){const n=this.unloadCheckedKeys[a];this.mapData[n]&&(this.setChecked(n,!0,!1,!1),this.unloadCheckedKeys.splice(a,1))}const r=this.getCheckedKeys();r.length===s.length&&r.every(a=>s.some(n=>n===a))||this.emit("checked-change",this.getCheckedNodes(),r)}setUnloadSelectedKey(e){const s=this.getSelectedKey();this.mapData[e]?(this.setSelected(e,!0,!1),this.unloadSelectedKey=null):(this.currentSelectedKey&&this.setSelected(this.currentSelectedKey,!1,!1),this.unloadSelectedKey=e);const i=this.getSelectedKey();i!==s&&this.emit("selected-change",this.getSelectedNode(),i)}flattenData(e,s=!0,i=[]){const r=e.length;for(let a=0;a<r;a++){const n=e[a],d=n[this.options.keyField];if(i.push(n),this.mapData[d])throw new Error("[CTree] Duplicate tree node key.");this.mapData[d]=n,n.checked&&this.options.cascade&&(this.checkNodeDownward(n,!0),this.checkNodeUpward(n)),n.selected&&s&&(this.clearSelected(!1,!1),this.currentSelectedKey=n[this.options.keyField],this.emit("selected-change",n,this.currentSelectedKey)),(this.options.defaultExpandAll||n.expand)&&!this.options.load&&!n.isLeaf&&(n.expand=!1,this.setExpand(n[this.options.keyField],!0,!1,!1,!1)),n.children.length&&this.flattenData(n.children,s,i)}return i}checkNodeDownward(e,s,i=!1){if(e.children.forEach(r=>{this.checkNodeDownward(r,s,i)}),e.isLeaf||this.options.load&&!e.children.length){if(!e.disabled){if(i&&!this.options.filteredNodeCheckable&&!e._filterVisible)return;e.checked=s,e.indeterminate=!1}}else this.checkParentNode(e)}checkNodeUpward(e){let s=e._parent;for(;s;)this.checkParentNode(s),s=s._parent}checkParentNode(e){const s=e.children.length;if(!s)return;let i=!1,r=!1,a=!1;for(let n=0;n<s;n++){const d=e.children[n];if(d.checked?i=!0:r=!0,i&&r||d.indeterminate){a=!0,e.checked=!1,e.indeterminate=!0;break}}a||(e.checked=i,e.indeterminate=!1)}findIndex(e,s=this.flatData){if(s!==null){let i=e instanceof b?e[this.options.keyField]:e;const r=s.length;for(let a=0;a<r;a++)if(s[0]instanceof b){if(i===s[a][this.options.keyField])return a}else if(i===s[a])return a}return-1}on(e,s){this.listenersMap[e]||(this.listenersMap[e]=[]);let i=[];Array.isArray(s)?i=s:i=[s],i.forEach(r=>{this.listenersMap[e].indexOf(r)===-1&&this.listenersMap[e].push(r)})}off(e,s){if(!!this.listenersMap[e])if(!s)this.listenersMap[e]=[];else{const i=this.listenersMap[e].indexOf(s);i>-1&&this.listenersMap[e].splice(i,1)}}emit(e,...s){if(!this.listenersMap[e])return;const i=this.listenersMap[e].length;for(let r=0;r<i;r++)this.listenersMap[e][r](...s)}}const U=S.default.extend({name:"CLoadingIcon"});function x(t,e,s,i,r,a,n,d){var l=typeof t=="function"?t.options:t;e&&(l.render=e,l.staticRenderFns=s,l._compiled=!0),i&&(l.functional=!0),a&&(l._scopeId="data-v-"+a);var o;if(n?(o=function(m){m=m||this.$vnode&&this.$vnode.ssrContext||this.parent&&this.parent.$vnode&&this.parent.$vnode.ssrContext,!m&&typeof __VUE_SSR_CONTEXT__<"u"&&(m=__VUE_SSR_CONTEXT__),r&&r.call(this,m),m&&m._registeredComponents&&m._registeredComponents.add(n)},l._ssrRegister=o):r&&(o=d?function(){r.call(this,(l.functional?this.parent:this).$root.$options.shadowRoot)}:r),o)if(l.functional){l._injectStyles=o;var h=l.render;l.render=function(pe,H){return o.call(H),h(pe,H)}}else{var c=l.beforeCreate;l.beforeCreate=c?[].concat(c,o):[o]}return{exports:t,options:l}}var j=function(){var e=this,s=e._self._c;return e._self._setupProxy,s("svg",{attrs:{viewBox:"0 0 50 50"}},[s("circle",{staticClass:"ctree-loading-icon__circle",attrs:{cx:"25",cy:"25",r:"20",fill:"none","stroke-width":"5","stroke-miterlimit":"10"}})])},X=[],Y=x(U,j,X,!1,null,null,null,null);const F=Y.exports,u="ctree-tree-node",q=S.default.extend({name:"CTreeNode",inheritAttrs:!1,components:{LoadingIcon:F},props:{data:Object,titleField:String,keyField:String,render:Function,checkable:Boolean,selectable:Boolean,unselectOnClick:Boolean,disableAll:Boolean,draggable:Boolean,droppable:Boolean},data(){return{dragoverBody:!1,dragoverBefore:!1,dragoverAfter:!1}},computed:{wrapperCls(){return[`${u}__wrapper`,{[`${u}__wrapper_is-leaf`]:this.data.isLeaf}]},nodeBodyCls(){return[`${u}__node-body`,{[`${u}__drop_active`]:this.dragoverBody}]},dropBeforeCls(){return[`${u}__drop`,{[`${u}__drop_active`]:this.dragoverBefore}]},dropAfterCls(){return[`${u}__drop`,{[`${u}__drop_active`]:this.dragoverAfter}]},squareCls(){return[`${u}__square`]},expandCls(){return[`${u}__expand`,{[`${u}__expand_active`]:this.data.expand}]},loadingIconCls(){return[`${u}__loading-icon`]},checkboxCls(){return[`${u}__checkbox`,{[`${u}__checkbox_checked`]:this.data.checked,[`${u}__checkbox_indeterminate`]:this.data.indeterminate,[`${u}__checkbox_disabled`]:this.disableAll||this.data.disabled}]},titleCls(){return[`${u}__title`,{[`${u}__title_selected`]:this.data.selected,[`${u}__title_disabled`]:this.disableAll||this.data.disabled}]},fullData(){return this.$parent.getNode(this.data[this.keyField])||{}},showCheckbox(){return this.checkable},renderFunction(){return this.data.render||this.render||null},renderComponent(){return S.default.extend({name:"Render",functional:!0,render:t=>typeof this.renderFunction!="function"?t("div"):this.renderFunction(t,this.fullData)})},dragListeners(){let t={};return this.draggable&&!this.disableAll&&!this.data.disabled&&(t={dragstart:this.handleDragStart}),t},dropListeners(){let t={};return this.droppable&&(t={dragenter:this.handleDragEnter.bind(this),dragover:this.handleDragOver.bind(this),dragleave:this.handleDragLeave.bind(this),drop:this.handleDrop.bind(this)}),t}},methods:{handleExpand(){this.data.isLeaf||this.$emit("expand",this.fullData)},handleCheck(){this.disableAll||this.data.disabled||!this.checkable||this.$emit("check",this.fullData)},handleSelect(){if(this.$emit("click",this.fullData),this.selectable){if(this.disableAll||this.data.disabled||this.data.selected&&!this.unselectOnClick)return;this.$emit("select",this.fullData)}else this.checkable?this.handleCheck():this.handleExpand()},handleDblclick(){this.$emit("node-dblclick",this.fullData)},handleRightClick(){this.$emit("node-right-click",this.fullData)},getHoverPart(t){const e=this.$refs.nodeBody.getBoundingClientRect(),s=e.height,i=t.clientY-e.top;return i<=s*.3?_.before:i<=s*(.3+.4)?_.body:_.after},resetDragoverFlags(t,e=!1){this.dragoverBefore=!1,this.dragoverBody=!1,this.dragoverAfter=!1,e||(t===_.before?this.dragoverBefore=!0:t===_.body?this.dragoverBody=!0:t===_.after&&(this.dragoverAfter=!0))},handleDragStart(t){t.dataTransfer&&t.dataTransfer.setData("node",JSON.stringify(this.data)),this.data.expand&&this.handleExpand(),this.$emit("node-dragstart",this.fullData,t)},handleDragEnter(t){t.preventDefault();const e=this.getHoverPart(t);this.resetDragoverFlags(e),this.$emit("node-dragenter",this.fullData,t,e)},handleDragOver(t){t.preventDefault();const e=this.getHoverPart(t);this.resetDragoverFlags(e),this.$emit("node-dragover",this.fullData,t,e)},handleDragLeave(t){const e=this.getHoverPart(t);this.resetDragoverFlags(e,!0),this.$emit("node-dragleave",this.fullData,t,e)},handleDrop(t){const e=this.getHoverPart(t);this.resetDragoverFlags(e,!0),this.$emit("node-drop",this.fullData,t,e)}}});var z=function(){var e=this,s=e._self._c;return e._self._setupProxy,s("div",{class:e.wrapperCls},[s("div",{class:e.dropBeforeCls}),s("div",e._g({ref:"nodeBody",class:e.nodeBodyCls},e.dropListeners),[s("div",{class:e.squareCls},[s("i",{directives:[{name:"show",rawName:"v-show",value:!e.data.isLeaf&&!e.data._loading,expression:"!data.isLeaf && !data._loading"}],class:e.expandCls,on:{click:e.handleExpand}}),e.data._loading?s("LoadingIcon",{class:e.loadingIconCls}):e._e()],1),e.showCheckbox?s("div",{class:e.squareCls},[s("div",{class:e.checkboxCls,on:{click:e.handleCheck}})]):e._e(),s("div",e._g({class:e.titleCls,attrs:{draggable:e.draggable&&!e.disableAll&&!e.data.disabled},on:{click:e.handleSelect,dblclick:e.handleDblclick,contextmenu:e.handleRightClick}},e.dragListeners),[e.renderFunction?s(e.renderComponent,{tag:"component"}):[e._v(e._s(e.data[e.titleField]))]],2)]),s("div",{class:e.dropAfterCls})])},J=[],G=x(q,z,J,!1,null,null,null,null);const T=G.exports,C="ctree-tree",E=["expand","select","unselect","selected-change","check","uncheck","checked-change","set-data"],Q=["node-drop"],Z=(t,e)=>{if(Array.isArray(t)&&Array.isArray(e)){if(t.length===e.length&&t.every(s=>e.some(i=>i===s)))return!0}else if(t===e)return!0;return!1},ee=S.default.extend({name:"CTree",components:{CTreeNode:T,LoadingIcon:F},props:{value:[String,Number,Array],data:{type:Array,default:()=>[]},unloadDataList:{type:Array,default:()=>[]},showUnloadCheckedNodes:{type:Boolean,default:!0},emptyText:{type:String,default:"\u6682\u65E0\u6570\u636E"},titleField:{type:String,default:"title"},keyField:{type:String,default:"id"},separator:{type:String,default:","},checkable:{type:Boolean,default:!1},selectable:{type:Boolean,default:!1},filteredNodeCheckable:{type:Boolean,default:!1},cascade:{type:Boolean,default:!0},enableLeafOnly:{type:Boolean,default:!1},disableAll:{type:Boolean,default:!1},defaultExpandAll:{type:Boolean,default:!1},defaultExpandedKeys:{type:Array,default:()=>[]},expandedKeys:{type:Array,default:()=>[]},draggable:{type:Boolean,default:!1},droppable:{type:Boolean,default:!1},beforeDropMethod:{type:Function,default:()=>()=>!0},ignoreMode:{type:String,default:w.none},autoLoad:{type:Boolean,default:!0},load:Function,render:Function,filterMethod:Function,expandOnFilter:{type:Boolean,default:!0},unselectOnClick:{type:Boolean,default:!0},loading:{type:Boolean,default:!1},nodeMinHeight:{type:Number,default:30},nodeIndent:{type:Number,default:20},renderNodeAmount:{type:Number,default:100},bufferNodeAmount:{type:Number,default:20},nodeClassName:{type:[String,Object,Array,Function]},usePadding:{type:Boolean,default:!1}},data(){const t=Array.isArray(this.value)?this.value.concat():this.value;return{unloadCheckedNodes:[],blockLength:0,blockAreaHeight:0,topSpaceHeight:0,bottomSpaceHeight:0,renderAmount:0,renderAmountCache:0,renderNodes:[],renderStart:0,renderStartCache:0,isRootLoading:!1,valueCache:t,debounceTimer:void 0}},computed:{topSpaceStyles(){return{height:`${this.topSpaceHeight}px`}},bottomSpaceStyles(){return{height:`${this.bottomSpaceHeight}px`}},wrapperCls(){return[`${C}__wrapper`]},scrollAreaCls(){return[`${C}__scroll-area`]},blockAreaCls(){return[`${C}__block-area`]},emptyCls(){return[`${C}__empty`]},emptyTextDefaultCls(){return[`${C}__empty-text_default`]},loadingCls(){return[`${C}__loading`]},loadingWrapperCls(){return[`${C}__loading-wrapper`]},loadingIconCls(){return[`${C}__loading-icon`]},iframeCls(){return[`${C}__iframe`]},treeNodeListeners(){let t={};for(let e in this.$listeners)E.indexOf(e)===-1&&Q.indexOf(e)===-1&&(t[e]=this.$listeners[e]);return t}},methods:{setData(t){this.resetSpaceHeights();let e=null,s=null;this.checkable?Array.isArray(this.value)?e=this.value.concat():typeof this.value=="string"&&(e=this.value===""?[]:this.value.split(this.separator)):this.selectable&&!Array.isArray(this.value)&&(s=this.value),this.nonReactive.store.setData(t,s,e),this.updateExpandedKeys()},setChecked(t,e){this.nonReactive.store.setChecked(t,e)},setCheckedKeys(t,e){this.nonReactive.store.setCheckedKeys(t,e)},checkAll(){this.nonReactive.store.checkAll()},clearChecked(){this.nonReactive.store.clearChecked()},setSelected(t,e){this.nonReactive.store.setSelected(t,e)},clearSelected(){this.nonReactive.store.clearSelected()},setExpand(t,e,s=!0){this.nonReactive.store.setExpand(t,e,s)},setExpandKeys(t,e){this.nonReactive.store.setExpandKeys(t,e)},setExpandAll(t){this.nonReactive.store.setExpandAll(t)},getCheckedNodes(t){return t=t||this.ignoreMode,this.nonReactive.store.getCheckedNodes(t)},getCheckedKeys(t){return t=t||this.ignoreMode,this.nonReactive.store.getCheckedKeys(t)},getIndeterminateNodes(){return this.nonReactive.store.getIndeterminateNodes()},getSelectedNode(){return this.nonReactive.store.getSelectedNode()},getSelectedKey(){return this.nonReactive.store.getSelectedKey()},getExpandNodes(){return this.nonReactive.store.getExpandNodes()},getExpandKeys(){return this.nonReactive.store.getExpandKeys()},getCurrentVisibleNodes(){return this.nonReactive.store.flatData.filter(t=>t._filterVisible)},getNode(t){return this.nonReactive.store.getNode(t)},getTreeData(){return this.nonReactive.store.data},getFlatData(){return this.nonReactive.store.flatData},getNodesCount(){return this.nonReactive.store.flatData.length},insertBefore(t,e){return this.nonReactive.store.insertBefore(t,e)},insertAfter(t,e){return this.nonReactive.store.insertAfter(t,e)},append(t,e){return this.nonReactive.store.append(t,e)},prepend(t,e){return this.nonReactive.store.prepend(t,e)},remove(t){return this.nonReactive.store.remove(t)},filter(t,e){const s=(i,r)=>{const a=r[this.titleField];return a==null||!a.toString?!1:a.toString().toLowerCase().indexOf(i.toLowerCase())>-1};e=e||this.filterMethod||s,this.nonReactive.store.filter(t,e)},showCheckedNodes(t){if(!this.checkable)return;t=t==null?this.showUnloadCheckedNodes:t;const e=this.nonReactive.store.getCheckedNodes();if(this.nonReactive.store.filter("",(i,r)=>r.checked),!t)return;const s=this.nonReactive.store.getUnloadCheckedKeys();if(s.length){const i=s.map(r=>{const a=this.unloadDataList.concat(e);let n=r;return a.some(d=>d[this.keyField]===r&&d[this.titleField]!=null?(n=d[this.titleField],!0):!1),new b({[this.keyField]:r,[this.titleField]:n,checked:!0,isLeaf:!0},null,this.keyField,!!this.load)});this.unloadCheckedNodes=i,this.nonReactive.blockNodes.push(...i),this.updateBlockData(),this.updateRender()}},loadRootNodes(){return this.isRootLoading=!0,new Promise((t,e)=>{this.load(null,t,e)}).then(t=>{Array.isArray(t)&&this.setData(t)}).catch(()=>{}).then(()=>{this.isRootLoading=!1})},scrollTo(t,e=$.top){const s=this.nonReactive.store.mapData[t];if(!s||!s.visible)return;let i=-1;for(let a=0;a<this.blockLength;a++)if(this.nonReactive.blockNodes[a][this.keyField]===t){i=a;break}if(i===-1)return;let r=i*this.nodeMinHeight;if(e===$.center){const a=this.$refs.scrollArea.clientHeight;r=r-(a-this.nodeMinHeight)/2}else if(e===$.bottom){const a=this.$refs.scrollArea.clientHeight;r=r-(a-this.nodeMinHeight)}else typeof e=="number"&&(r=r-e);this.$refs.scrollArea.scrollTop=r},updateExpandedKeys(){this.expandedKeys.length&&(this.nonReactive.store.setExpandAll(!1,!1),this.nonReactive.store.setExpandKeys(this.expandedKeys,!0))},updateUnloadStatus(){if(this.unloadCheckedNodes.length){const t=this.nonReactive.store.getUnloadCheckedKeys();this.unloadCheckedNodes.forEach(e=>{e.checked=t.indexOf(e[this.keyField])>-1})}},handleNodeCheck(t){!this.cascade&&this.enableLeafOnly&&!t.isLeaf||this.nonReactive.store.setChecked(t[this.keyField],t.indeterminate?!1:!t.checked,!0,!0,!0)},handleNodeSelect(t){this.enableLeafOnly&&!t.isLeaf||this.nonReactive.store.setSelected(t[this.keyField],!t.selected)},handleNodeExpand(t){this.nonReactive.store.setExpand(t[this.keyField],!t.expand)},handleNodeDrop(t,e,s){if(!!this.droppable&&e.dataTransfer)try{const r=JSON.parse(e.dataTransfer.getData("node"))[this.keyField],a=t[this.keyField];if(this.beforeDropMethod(r,a,s)){if(r===a)return;s===_.before?this.nonReactive.store.insertBefore(r,a):s===_.body||!t.isLeaf&&t.expand?this.nonReactive.store.prepend(r,a):s===_.after&&this.nonReactive.store.insertAfter(r,a),this.$emit("node-drop",t,e,s,this.getNode(r))}}catch(i){throw new Error(i)}},emitCheckableInput(t,e){if(this.checkable){let s=e;Array.isArray(this.value)||(s=s.join(this.separator)),Array.isArray(s)?this.valueCache=s.concat():this.valueCache=s,this.$emit("input",s)}},emitSelectableInput(t,e){if(this.selectable&&!this.checkable){const s=e||"";this.valueCache=s,this.$emit("input",s)}},attachStoreEvents(){for(let t in this.$listeners)if(E.indexOf(t)>-1){const e=t;this.nonReactive.store.on(e,this.$listeners[t])}},resetSpaceHeights(){this.topSpaceHeight=0,this.bottomSpaceHeight=0,this.$refs.scrollArea.scrollTop=0},updateBlockNodes(){this.nonReactive.blockNodes=this.nonReactive.store.flatData.filter(t=>t.visible),this.updateBlockData(),this.updateRender()},updateBlockData(){this.blockLength=this.nonReactive.blockNodes.length,this.blockAreaHeight=this.nodeMinHeight*this.blockLength},updateRender(){this.updateRenderAmount(),this.updateRenderNodes()},updateRenderAmount(){const t=this.$refs.scrollArea.clientHeight;this.renderAmount=Math.max(this.renderNodeAmount,Math.ceil(t/this.nodeMinHeight)+this.bufferNodeAmount)},updateRenderNodes(t=!1){if(this.blockLength>this.renderAmount){const e=this.$refs.scrollArea.scrollTop,s=Math.floor(e/this.nodeMinHeight);this.renderStart=Math.floor(s/this.bufferNodeAmount)*this.bufferNodeAmount}else this.renderStart=0;t&&this.renderAmountCache===this.renderAmount&&this.renderStartCache===this.renderStart||(this.renderNodes=this.nonReactive.blockNodes.slice(this.renderStart,this.renderStart+this.renderAmount).map(e=>Object.assign({},e,{_parent:null,children:[]})),this.topSpaceHeight=this.renderStart*this.nodeMinHeight,this.bottomSpaceHeight=this.blockAreaHeight-(this.topSpaceHeight+this.renderNodes.length*this.nodeMinHeight))},handleTreeScroll(){this.debounceTimer&&window.cancelAnimationFrame(this.debounceTimer),this.renderAmountCache=this.renderAmount,this.renderStartCache=this.renderStart,this.debounceTimer=window.requestAnimationFrame(this.updateRenderNodes.bind(this,!0))}},created(){const{keyField:t,ignoreMode:e,filteredNodeCheckable:s,cascade:i,defaultExpandAll:r,load:a,expandOnFilter:n}=this;this.nonReactive={store:new W({keyField:t,ignoreMode:e,filteredNodeCheckable:s,cascade:i,defaultExpandAll:r,load:a,expandOnFilter:n}),blockNodes:[]},this.nonReactive.store.on("visible-data-change",this.updateBlockNodes),this.nonReactive.store.on("render-data-change",this.updateRender),this.nonReactive.store.on("checked-change",(d,l)=>{this.emitCheckableInput(d,l),this.updateUnloadStatus()}),this.nonReactive.store.on("selected-change",this.emitSelectableInput),this.attachStoreEvents()},mounted(){this.data.length?(this.setData(this.data),this.defaultExpandedKeys.length&&this.nonReactive.store.setExpandKeys(this.defaultExpandedKeys,!0)):typeof this.load=="function"&&this.autoLoad&&this.loadRootNodes();const t=this.$refs.iframe;t.contentWindow&&t.contentWindow.addEventListener("resize",this.updateRender)},beforeDestroy(){const t=this.$refs.iframe;t.contentWindow&&t.contentWindow.removeEventListener("resize",this.updateRender)},watch:{value(t){if(this.checkable){if(Z(t,this.valueCache))return;let e=[];Array.isArray(t)?e=t.concat():typeof t=="string"&&(e=t===""?[]:t.split(this.separator)),this.nonReactive.store.clearChecked(!1,!1),this.nonReactive.store.setCheckedKeys(e,!0)}else if(this.selectable){if(t===this.valueCache)return;const e=this.nonReactive.store.getSelectedKey();t!==""&&t!=null?this.nonReactive.store.setSelected(t,!0):(t===""||t==null)&&e&&this.nonReactive.store.setSelected(e,!1)}},data:{deep:!0,handler(t){this.setData(t)}},expandedKeys(){this.updateExpandedKeys()},$listeners(){this.attachStoreEvents()}}});var te=function(){var e=this,s=e._self._c;return e._self._setupProxy,s("div",{class:e.wrapperCls},[s("div",{ref:"scrollArea",class:e.scrollAreaCls,on:{"&scroll":function(i){return i.stopPropagation(),e.handleTreeScroll.apply(null,arguments)}}},[s("div",{class:e.blockAreaCls},[s("div",{style:e.topSpaceStyles}),e._l(e.renderNodes,function(i,r){return s("CTreeNode",e._g(e._b({key:i[e.keyField],class:typeof e.nodeClassName=="function"?e.nodeClassName(i):e.nodeClassName,style:{minHeight:`${e.nodeMinHeight}px`,marginLeft:e.usePadding?null:`${i._level*e.nodeIndent}px`,paddingLeft:e.usePadding?`${i._level*e.nodeIndent}px`:null},attrs:{data:i},on:{check:e.handleNodeCheck,select:e.handleNodeSelect,expand:e.handleNodeExpand,"node-drop":e.handleNodeDrop}},"CTreeNode",e.$props,!1),e.treeNodeListeners))}),s("div",{style:e.bottomSpaceStyles})],2)]),s("div",{directives:[{name:"show",rawName:"v-show",value:!e.blockLength,expression:"!blockLength"}],class:e.emptyCls},[s("span",{class:e.emptyTextDefaultCls},[e._t("empty",function(){return[e._v(" "+e._s(e.emptyText)+" ")]})],2)]),s("div",{directives:[{name:"show",rawName:"v-show",value:e.loading||e.isRootLoading,expression:"loading || isRootLoading"}],class:e.loadingCls},[s("div",{class:e.loadingWrapperCls},[e._t("loading",function(){return[s("LoadingIcon",{class:e.loadingIconCls})]})],2)]),s("iframe",{ref:"iframe",class:e.iframeCls})])},se=[],ie=x(ee,te,se,!1,null,null,null,null);const A=ie.exports,k="ctree-tree-search",D="ctree-tree-node";let B={};const I=A.options.methods;for(let t in I){const e=t;if(K.indexOf(e)>-1){const s=B;s[e]=function(...i){return I[e].apply(this.$refs.tree,i)}}}const re=S.default.extend({name:"CTreeSearch",inheritAttrs:!1,components:{CTree:A},props:{value:{},searchPlaceholder:{type:String,default:"\u641C\u7D22\u5173\u952E\u5B57"},showCheckAll:{type:Boolean,default:!0},showCheckedButton:{type:Boolean,default:!0},checkedButtonText:{type:String,default:"\u5DF2\u9009"},showFooter:{type:Boolean,default:!0},searchMethod:Function,searchLength:{type:Number,default:1},searchDisabled:{type:Boolean,default:!1},searchRemote:{type:Boolean,default:!1},searchDebounceTime:{type:Number,default:300}},data(){return{checkAllStatus:{checked:!1,indeterminate:!1,disabled:!1},isShowingChecked:!1,keyword:"",debounceTimer:void 0,checkedCount:0}},computed:{wrapperCls(){return[`${k}__wrapper`]},searchCls(){return[`${k}__search`]},checkAllWrapperCls(){return[`${k}__check-all-wrapper`]},checkboxCls(){return[`${k}__check-all`,`${D}__checkbox`,{[`${D}__checkbox_checked`]:this.checkAllStatus.checked,[`${D}__checkbox_indeterminate`]:this.checkAllStatus.indeterminate,[`${D}__checkbox_disabled`]:this.searchDisabled||this.checkAllStatus.disabled}]},inputWrapperCls(){return[`${k}__input-wrapper`]},inputCls(){return[`${k}__input`,{[`${k}__input_disabled`]:this.searchDisabled}]},actionWrapperCls(){return[`${k}__action-wrapper`]},checkedButtonCls(){return[`${k}__checked-button`,{[`${k}__checked-button_active`]:this.isShowingChecked}]},treeWrapperCls(){return[`${k}__tree-wrapper`]},footerCls(){return[`${k}__footer`]},checkable(){return"checkable"in this.$attrs&&this.$attrs.checkable!==!1}},methods:{...B,clearKeyword(){this.keyword=""},getKeyword(){return this.keyword},search(t){let e=t;return typeof t!="string"&&(e=this.keyword),new Promise((s,i)=>{clearTimeout(this.debounceTimer),this.debounceTimer=setTimeout(()=>{if(!(e.length>0&&e.length<this.searchLength))if(this.isShowingChecked=!1,this.$emit("search",e),typeof this.searchMethod=="function"){const r=this.searchMethod(e);Promise.resolve(r).then(()=>{this.updateCheckAllStatus(),s()})}else this.searchRemote?this.$refs.tree.loadRootNodes().then(()=>{this.updateCheckAllStatus(),s()}):(this.$refs.tree.filter(e),this.updateCheckAllStatus(),s())},this.searchDebounceTime)})},handleCheckAll(){if(this.searchDisabled||this.checkAllStatus.disabled)return;const t=this.$refs.tree.getCurrentVisibleNodes().map(e=>e[this.$refs.tree.keyField]);this.checkAllStatus.checked||this.checkAllStatus.indeterminate?this.$refs.tree.setCheckedKeys(t,!1):this.$refs.tree.setCheckedKeys(t,!0),this.updateCheckAllStatus()},handleSearch(){this.search()},handleShowChecked(){const t=()=>{this.isShowingChecked=!this.isShowingChecked,this.isShowingChecked?this.$refs.tree.showCheckedNodes():this.$refs.tree.filter(this.keyword,()=>!0),this.updateCheckAllStatus()};this.keyword?(this.clearKeyword(),this.search().then(()=>{t()})):t()},handleSetData(){this.updateCheckedCount(),this.updateCheckAllStatus()},updateCheckAllStatus(){const t=this.$refs.tree.getCurrentVisibleNodes(),e=t.length;let s=!1,i=!1,r=!1;for(let a=0;a<e;a++){const n=t[a];if(n.checked?s=!0:i=!0,s&&i||n.indeterminate){r=!0,this.checkAllStatus.checked=!1,this.checkAllStatus.indeterminate=!0;break}}r||(this.checkAllStatus.checked=s,this.checkAllStatus.indeterminate=!1)},updateCheckedCount(){this.checkedCount=this.$refs.tree.getCheckedKeys().length}},mounted(){this.checkable&&!this.checkedCount&&this.handleSetData()}});var ae=function(){var e=this,s=e._self._c;return e._self._setupProxy,s("div",{class:e.wrapperCls},[s("div",{class:e.searchCls},[e.showCheckAll&&e.checkable?s("div",{class:e.checkAllWrapperCls},[s("div",{class:e.checkboxCls,on:{click:e.handleCheckAll}})]):e._e(),s("div",{class:e.inputWrapperCls},[e._t("search-input",function(){return[s("input",{directives:[{name:"model",rawName:"v-model",value:e.keyword,expression:"keyword"}],class:e.inputCls,attrs:{type:"text",placeholder:e.searchPlaceholder,disabled:e.searchDisabled},domProps:{value:e.keyword},on:{input:[function(i){i.target.composing||(e.keyword=i.target.value)},e.handleSearch]}})]})],2),s("div",{class:e.actionWrapperCls},[e.showCheckedButton&&e.checkable?s("span",{class:e.checkedButtonCls,on:{click:e.handleShowChecked}},[e._v(" "+e._s(e.checkedButtonText)+" ")]):e._e(),e._t("actions")],2)]),s("div",{class:e.treeWrapperCls},[s("CTree",e._g(e._b({ref:"tree",attrs:{value:e.value},on:{input:e.updateCheckedCount,"set-data":e.handleSetData,"checked-change":e.updateCheckAllStatus},scopedSlots:e._u([e._l(e.$scopedSlots,function(i,r){return{key:r,fn:function(a){return[e._t(r,null,null,a)]}}})],null,!0)},"CTree",e.$attrs,!1),e.$listeners))],1),e.showFooter&&e.checkable?s("div",{class:e.footerCls},[e._t("footer",function(){return[s("span",{staticStyle:{float:"right"}},[e._v("\u5DF2\u9009 "+e._s(e.checkedCount)+" \u4E2A")])]})],2):e._e()])},ne=[],le=x(re,ae,ne,!1,null,null,null,null);const N=le.exports,y="ctree-tree-drop",L="ctree-tree-search";let M={},de=K.concat(V);const O=N.options.methods;for(let t in O){const e=t;if(de.indexOf(e)>-1){const s=M;s[e]=function(...i){return O[e].apply(this.$refs.treeSearch,i)}}}const oe=S.default.extend({name:"CTreeDrop",inheritAttrs:!1,components:{CTreeSearch:N},props:{value:{},dropHeight:{type:Number,default:300},dropPlaceholder:{type:String},dropDisabled:{type:Boolean,default:!1},clearable:{type:Boolean,default:!1},placement:{type:String,default:R["bottom-start"]},transfer:{type:Boolean,default:!1},dropdownClassName:{type:[String,Array]},dropdownMinWidth:{type:Number},dropdownWidthFixed:{type:Boolean,default:!1}},data(){return{dropdownVisible:!1,checkedCount:0,selectedTitle:"",slotProps:{checkedNodes:[],checkedKeys:[],selectedNode:null,selectedKey:null}}},computed:{wrapperCls(){return[`${y}__wrapper`]},referenceCls(){return[`${y}__reference`]},displayInputCls(){return[`${L}__input`,`${y}__display-input`,{[`${y}__display-input_focus`]:this.dropdownVisible,[`${L}__input_disabled`]:this.dropDisabled}]},displayInputTextCls(){let t=!1;return typeof this.dropPlaceholder=="string"&&(this.checkable?t=this.checkedCount===0:this.selectable&&(t=this.selectedTitle==="")),[`${y}__display-input-text`,{[`${y}__display-input-placeholder`]:t}]},dropIconCls(){return[`${y}__display-icon-drop`,{[`${y}__display-icon-drop_active`]:this.dropdownVisible}]},clearIconCls(){return[`${y}__display-icon-clear`]},dropdownCls(){const t=Array.isArray(this.dropdownClassName)?this.dropdownClassName:[this.dropdownClassName];return[`${y}__dropdown`,...t]},checkable(){return"checkable"in this.$attrs&&this.$attrs.checkable!==!1},selectable(){return"selectable"in this.$attrs&&this.$attrs.selectable!==!1},displayValue(){return this.checkable?this.checkedCount===0&&typeof this.dropPlaceholder=="string"?this.dropPlaceholder:`\u5DF2\u9009 ${this.checkedCount} \u4E2A`:this.selectable?this.selectedTitle===""&&typeof this.dropPlaceholder=="string"?this.dropPlaceholder:this.selectedTitle:this.dropPlaceholder||""},showClearIcon(){return this.checkable?this.checkedCount!==0:this.selectable?this.selectedTitle!=="":!1}},methods:{...M,locateDropdown(){const t=this.$refs.reference.getBoundingClientRect(),e=t.width,s=t.height,i=`${typeof this.dropdownMinWidth=="number"?this.dropdownMinWidth:e}px`;this.$refs.dropdown.style.minWidth=i,this.$refs.dropdown.style.width=this.dropdownWidthFixed?i:"auto";const r=this.$refs.dropdown.getBoundingClientRect(),a=window.getComputedStyle(this.$refs.dropdown),n=parseFloat(a.marginLeft)+parseFloat(a.marginRight),d=parseFloat(a.marginTop)+parseFloat(a.marginBottom),l=r.width+n,o=r.height/.8+d;let h=0,c=0;switch(this.transfer&&(h=-999,c=-999),this.placement){case"bottom-start":this.transfer?(h=window.pageYOffset+t.bottom,c=window.pageXOffset+t.left):h=s;break;case"bottom-end":this.transfer?(h=window.pageYOffset+t.bottom,c=window.pageXOffset+t.right-l):(h=s,c=e-l);break;case"bottom":this.transfer?(h=window.pageYOffset+t.bottom,c=window.pageXOffset+t.left+(e-l)/2):(h=s,c=(e-l)/2);break;case"top-start":this.transfer?(h=window.pageYOffset+t.top-o,c=window.pageXOffset+t.left):h=-o;break;case"top-end":this.transfer?(h=window.pageYOffset+t.top-o,c=window.pageXOffset+t.right-l):(h=-o,c=e-l);break;case"top":this.transfer?(h=window.pageYOffset+t.top-o,c=window.pageXOffset+t.left+(e-l)/2):(h=-o,c=(e-l)/2);break}this.$refs.dropdown.style.top=`${h}px`,this.$refs.dropdown.style.left=`${c}px`},handleRefClick(){this.dropDisabled||(this.dropdownVisible=!this.dropdownVisible)},handleDocumentClick(t){!this.$refs||!this.$refs.reference.contains(t.target)&&!this.$refs.dropdown.contains(t.target)&&(this.dropdownVisible=!1)},handleClear(){this.$emit("clear"),this.checkable?this.clearChecked():this.selectable&&this.clearSelected()},handleCheckedChange(t,e){this.slotProps.checkedNodes=t,this.slotProps.checkedKeys=e,this.checkedCount=e.length},handleSelectedChange(t,e){if(this.slotProps.selectedNode=t,this.slotProps.selectedKey=e,t){const s=this.$refs.treeSearch.$refs.tree.titleField;this.selectedTitle=t[s]}else e?this.selectedTitle=e:this.selectedTitle="";this.dropdownVisible=!1},handleSetData(){if(this.slotProps.checkedNodes=this.getCheckedNodes(),this.slotProps.checkedKeys=this.getCheckedKeys(),this.slotProps.selectedNode=this.getSelectedNode(),this.slotProps.selectedKey=this.getSelectedKey(),this.checkable&&(this.checkedCount=this.slotProps.checkedKeys.length),this.selectable&&this.value!=null){const t=this.getNode(this.value);if(t){const e=this.$refs.treeSearch.$refs.tree.titleField;this.selectedTitle=t[e]}else this.selectedTitle=this.value}}},mounted(){document.addEventListener("click",this.handleDocumentClick),this.transfer&&document.body.appendChild(this.$refs.dropdown),this.handleSetData()},beforeDestroy(){document.removeEventListener("click",this.handleDocumentClick),this.$refs.dropdown.remove()},watch:{dropdownVisible(t){this.$emit("dropdown-visible-change",t),t?this.$nextTick(()=>{this.locateDropdown()}):this.$refs.treeSearch.getKeyword()&&(this.$refs.treeSearch.clearKeyword(),this.$refs.treeSearch.search())}}});var he=function(){var e=this,s=e._self._c;return e._self._setupProxy,s("div",{class:e.wrapperCls},[s("div",{ref:"reference",class:e.referenceCls,on:{click:e.handleRefClick}},[e._t("default",function(){return[s("div",{class:e.displayInputCls},[s("span",{class:e.displayInputTextCls},[e._t("display",function(){return[e._v(" "+e._s(e.displayValue)+" ")]},null,e.slotProps)],2),e.dropDisabled?e._e():[s("i",{class:e.dropIconCls}),e.clearable&&e.showClearIcon?e._t("clear",function(){return[s("i",{class:e.clearIconCls,on:{click:function(i){return i.stopPropagation(),e.handleClear.apply(null,arguments)}}})]}):e._e()]],2)]},null,e.slotProps)],2),s("transition",{attrs:{name:"ctree-dropdown"}},[s("div",{directives:[{name:"show",rawName:"v-show",value:e.dropdownVisible,expression:"dropdownVisible"}],ref:"dropdown",class:e.dropdownCls,style:{height:`${e.dropHeight}px`}},[s("CTreeSearch",e._g(e._b({ref:"treeSearch",attrs:{value:e.value},on:{"set-data":e.handleSetData,"checked-change":e.handleCheckedChange,"selected-change":e.handleSelectedChange},scopedSlots:e._u([e._l(e.$scopedSlots,function(i,r){return{key:r,fn:function(a){return[e._t(r,null,null,a)]}}})],null,!0)},"CTreeSearch",e.$attrs,!1),e.$listeners))],1)])],1)},ce=[],fe=x(oe,he,ce,!1,null,null,null,null);const ue=fe.exports,_e="";p.CTreeDrop=ue,p.CTreeNode=T,p.CTreeSearch=N,p.default=A,Object.defineProperties(p,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})});
